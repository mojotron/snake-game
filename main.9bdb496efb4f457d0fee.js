(()=>{"use strict";const e={newInput:!1,gridSize:"small",snakeSpeed:"slow",direction:"right",foodCoords:null,currentScore:0,highScore:{small:{slow:0,normal:0,fast:0},normal:{slow:0,normal:0,fast:0},large:{slow:0,normal:0,fast:0}}},t=()=>{e.highScore[e.gridSize][e.snakeSpeed]=e.currentScore,localStorage.setItem("highScores",JSON.stringify(e.highScore))};(()=>{const t=localStorage.getItem("highScores");t&&(e.highScore=JSON.parse(t))})();const s=new class{#e=document.querySelector(".board");#t;get element(){return this.#e}createGrid(e){this.#t=e,this.#e.style.setProperty("--rows",this.#t),this.#e.style.setProperty("--columns",this.#t)}clear(){this.#e.innerHTML=""}getRandomBoardPosition(){const e=()=>Math.floor(Math.random()*this.#t);return{x:e(),y:e()}}wallHit(e){return e.x<0||e.x===this.#t||e.y<0||e.y===this.#t}},i={size:{small:10,normal:15,large:20},speed:{slow:500,normal:300,fast:150}},n=[{x:3,y:2,direction:"right"},{x:3,y:1,direction:"right"},{x:3,y:0,direction:"right"}],r=(e,t=!1,s=!1)=>{const i=document.createElement("div");return t&&i.classList.add(t),s&&(i.innerHTML=s),i.style.gridArea=`${e.x+1}/${e.y+1}/${e.x+2}/${e.y+2}`,i};const a=new class{#s='\n    <div class="snake-head__eye"></div>\n    <div class="snake-head__eye"></div>\n    <div class="snake-head__tongue hidden"></div>\n  ';#i;#n;get head(){return{...this.#i.at(0)}}get snake(){return this.#i.map((e=>({...e})))}constructor(){this.new()}new(){this.#i=n.map((e=>({...e})))}move(e){this.#n=this.#i.at(-1),this.#i[0]={...this.#i[0]};for(let e=this.#i.length-1;e>0;e-=1)this.#i[e]={...this.#i[e-1]};"down"===e&&(this.#i[0].x+=1),"up"===e&&(this.#i[0].x-=1),"right"===e&&(this.#i[0].y+=1),"left"===e&&(this.#i[0].y-=1),this.#i[0].direction=e}grow(){this.#i.push(this.#n)}snakeHit(){return this.#i.slice(1).some((e=>e.x===this.#i[0].x&&e.y===this.#i[0].y))}display(e){this.#i.forEach(((t,s)=>{const i=r(this.#i[s],"snake");if(0===s)i.innerHTML=this.#s,i.classList.add("snake-head"),i.classList.add(`snake-rotate-${this.#i[0].direction}`);else if(s===this.#i.length-1){i.classList.add("snake-tail");const e=this.#i[s-1].direction,n=this.#i[s].direction;e===n&&i.classList.add(`snake-rotate-${t.direction}`),"left"===n&&"down"===e&&i.classList.add("snake-rotate-down"),"right"===n&&"down"===e&&i.classList.add("snake-rotate-down"),"left"===n&&"up"===e&&i.classList.add("snake-rotate-up"),"right"===n&&"up"===e&&i.classList.add("snake-rotate-up"),"up"===n&&"right"===e&&i.classList.add("snake-rotate-right"),"up"===n&&"left"===e&&i.classList.add("snake-rotate-left"),"down"===n&&"right"===e&&i.classList.add("snake-rotate-right"),"down"===n&&"left"===e&&i.classList.add("snake-rotate-left")}else{const e=this.#i[s-1].direction,t=this.#i[s].direction;"left"===t&&"down"===e&&i.classList.add("snake-top-left"),"right"===t&&"down"===e&&i.classList.add("snake-top-right"),"left"===t&&"up"===e&&i.classList.add("snake-bottom-left"),"right"===t&&"up"===e&&i.classList.add("snake-bottom-right"),"up"===t&&"right"===e&&i.classList.add("snake-top-left"),"up"===t&&"left"===e&&i.classList.add("snake-top-right"),"down"===t&&"right"===e&&i.classList.add("snake-bottom-left"),"down"===t&&"left"===e&&i.classList.add("snake-bottom-right")}e.append(i)}))}addGameOverEffect(){document.querySelectorAll(".snake-head__eye").forEach((e=>e.classList.add("dead"))),document.querySelector(".snake-head__tongue").classList.remove("hidden")}};const o=new class{#r;#a='\n    <div class="apple__body body-1"></div>\n    <div class="apple__body body-2"></div>\n    <div class="petiole"></div>\n    <div class="leaf"></div>\n  ';#o(e){const t=()=>Math.floor(Math.random()*e);return{x:t(),y:t()}}createCoords(e,t){return this.#r=this.#o(t),e.some((e=>e.x===this.#r.x&&e.y===this.#r.y))?this.createCoords(e,t):this.#r}display(e){const t=r(this.#r,"apple",this.#a);e.append(t)}foodEaten(e){return e.x===this.#r.x&&e.y===this.#r.y}};const d=new class{#d=document.getElementById("current-score");#c=document.getElementById("high-score");#l=document.querySelector(".score__grid-size");#h=document.querySelector(".score__snake-speed");displayCurrentScore(e){this.#d.textContent=e}updateScoreOptions(e,t){this.#l.textContent=e,this.#h.textContent=t}updateHighScore(e){this.#c.textContent=e}};const c=new class{#e=document.querySelector(".options");show(){this.#e.classList.remove("hidden")}hide(){this.#e.classList.add("hidden")}addClickHandler(e){this.#e.querySelector(".btn--start-new").addEventListener("click",(t=>{t.preventDefault();const s=this.#e.querySelector('input[name="size"]:checked').value,i=this.#e.querySelector('input[name="speed"]:checked').value;e(s,i)}))}};window.addEventListener("keydown",(t=>{if(!e.newInput){if("ArrowDown"===t.key){if("up"===e.direction)return;e.direction="down"}if("ArrowUp"===t.key){if("down"===e.direction)return;e.direction="up"}if("ArrowRight"===t.key){if("left"===e.direction)return;e.direction="right"}if("ArrowLeft"===t.key){if("right"===e.direction)return;e.direction="left"}e.newInput=!0}}));const l=()=>{e.currentScore>e.highScore[e.gridSize][e.snakeSpeed]&&(t(),d.updateHighScore(e.highScore[e.gridSize][e.snakeSpeed]))};let h;function p(t){void 0===h&&(h=t);if(t-h>i.speed[e.snakeSpeed]){if(h=t,a.move(e.direction),s.wallHit(a.head)||a.snakeHit())return l(),a.addGameOverEffect(),void c.show();o.foodEaten(a.head)&&(e.appleCoords=o.createCoords(a.snake,i.size[e.gridSize]),a.grow(),e.currentScore+=1,d.displayCurrentScore(e.currentScore)),s.clear(),o.display(s.element),a.display(s.element,e.direction),e.newInput=!1}window.requestAnimationFrame(p)}const u=()=>{s.createGrid(i.size[e.gridSize]),a.new(),e.direction="right",e.appleCoords=o.createCoords(a.snake,i.size[e.gridSize]),e.currentScore=0,d.displayCurrentScore(e.currentScore),d.updateHighScore(e.highScore[e.gridSize][e.snakeSpeed]),o.display(s.element),a.display(s.element),c.hide(),window.requestAnimationFrame(p)};c.addClickHandler(((t,s)=>{e.gridSize=t,e.snakeSpeed=s,d.updateScoreOptions(e.gridSize,e.snakeSpeed),u()}))})();